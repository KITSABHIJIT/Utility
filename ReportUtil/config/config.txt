MYSQL=//localhost:3306/expdb|root|abhijit

delimeter=[|]
commaDelimeter=[,]
figureDelimeter=[#]


EXPENSE_RECORDS=SELECT E.EXPENSE_DATE ,E.PAYMENT_MODE ,M.MERCHANT ,M.CATEGORY ,CASE WHEN M.DESCRIPTION IS NULL THEN '' ELSE M.DESCRIPTION END DESCRIPTION ,E.PLACE_OF_EXPENSE ,E.AMOUNT FROM EXPENSE E ,MERCHANT M WHERE E.MERCHANT=M.MERCHANT AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>'

EXPENSE_TOTAL=SELECT SUM(E.AMOUNT) AS TOTAL_EXPENSE FROM EXPENSE E WHERE EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>'

CATEGORY_EXPENSE=SELECT M.CATEGORY,CASE WHEN SUM(AMOUNT) IS NULL THEN 0.00 ELSE SUM(AMOUNT) END AS AMOUNT FROM  MERCHANT M LEFT OUTER JOIN EXPENSE E ON E.MERCHANT=M.MERCHANT  AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>' GROUP BY M.CATEGORY

PAYMENT_TYPE_EXPENSE=SELECT T.PAYMENT_METHOD,PL.PAY_LIMIT AS "CREDIT_LIMIT",T.AMOUNT AS "AMOUNT_SPENT",ROUND(((T.AMOUNT/PL.PAY_LIMIT)*100),2) AS "CREDIT_UTILIZATION_%" FROM PAYMODE PL, (SELECT P.PAYMENT_METHOD,CASE WHEN SUM(AMOUNT) IS NULL THEN 0.00 ELSE SUM(AMOUNT) END AS AMOUNT FROM  PAYMODE P LEFT OUTER JOIN EXPENSE E ON P.PAYMENT_METHOD=E.PAYMENT_MODE  AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>' GROUP BY P.PAYMENT_METHOD) T WHERE T.PAYMENT_METHOD =PL.PAYMENT_METHOD  AND PL.PAYMENT_TYPE = 'CREDIT CARD'

PIE_CATEGORY=SELECT M.CATEGORY,CASE WHEN SUM(AMOUNT) IS NULL THEN 0.00 ELSE SUM(AMOUNT) END AS AMOUNT FROM  MERCHANT M LEFT OUTER JOIN EXPENSE E ON E.MERCHANT=M.MERCHANT  AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>' GROUP BY M.CATEGORY

BAR_CATEGORY=SELECT M.CATEGORY,CASE WHEN SUM(AMOUNT) IS NULL THEN 0.00 ELSE SUM(AMOUNT) END AS AMOUNT FROM  MERCHANT M LEFT OUTER JOIN EXPENSE E ON E.MERCHANT=M.MERCHANT  AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>' GROUP BY M.CATEGORY

PIE_PAYMENT_TYPE=SELECT P.PAYMENT_METHOD,CASE WHEN SUM(AMOUNT) IS NULL THEN 0.00 ELSE SUM(AMOUNT) END AS AMOUNT FROM  PAYMODE P LEFT OUTER JOIN EXPENSE E ON P.PAYMENT_METHOD=E.PAYMENT_MODE  AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>' GROUP BY P.PAYMENT_METHOD

PIE_CREDIT_UTILIZATION=SELECT T.PAYMENT_METHOD,ROUND(((T.AMOUNT/PL.PAY_LIMIT)*100),2) AS "CREDIT_UTILIZATION_%" FROM PAYMODE PL, (SELECT P.PAYMENT_METHOD,CASE WHEN SUM(AMOUNT) IS NULL THEN 0.00 ELSE SUM(AMOUNT) END AS AMOUNT FROM  PAYMODE P LEFT OUTER JOIN EXPENSE E ON P.PAYMENT_METHOD=E.PAYMENT_MODE  AND EXPENSE_DATE >= '<START_DATE>' AND EXPENSE_DATE <= '<END_DATE>' GROUP BY P.PAYMENT_METHOD) T WHERE T.PAYMENT_METHOD =PL.PAYMENT_METHOD  AND PL.PAYMENT_TYPE = 'CREDIT CARD'

excelPath = C:\\Users\\royab001\\Google Drive\\Expense\\Expense Dumps\\Test Exported Data\\

excelFileExtn=.xls

excelDataFormat = dd-mmm-yyyy

excelFileNameFormat = MMddyy

REPORTS=EXPENSE_RECORDS,EXPENSE_TOTAL|CATEGORY_EXPENSE#PIE_CATEGORY,BAR_CATEGORY|PAYMENT_TYPE_EXPENSE#PIE_PAYMENT_TYPE,PIE_CREDIT_UTILIZATION

STARTDATE=<START_DATE>

ENDDATE=<END_DATE>

CONFIG_EXPENSE_RECORDS =4|1
CONFIG_EXPENSE_TOTAL =1|1
CONFIG_CATEGORY_EXPENSE =1|1
CONFIG_PAYMENT_TYPE_EXPENSE =1|1

CONFIG_PIE_CATEGORY =Expense By Category|true|true|false|900|400|0|4
CONFIG_PIE_PAYMENT_TYPE =Expense By Payment Mode|true|true|false|600|400|1|6
CONFIG_PIE_CREDIT_UTILIZATION =Credit Card Utilization|true|true|false|600|400|18|0

CONFIG_BAR_CATEGORY =Expense By Category|Category|Expense|true|true|false|900|500|24|4